{"pageProps":{"id":"2","title":"服务端仓库共享问题","prev":{"id":1,"title":"getServerSideProps方法"},"next":{"id":3,"title":"服务端渲染组件 & 客户端渲染组件"},"md":{"data":"# 服务端仓库共享问题\r\n只要服务端不关闭,无论多少次请求,无论是否是同一个客户端的请求,仓库总是同一个,这样当然不行\r\n\r\n使用函数创建仓库\r\n```js\r\nfunction makeStore(){\r\n  let store = null\r\n\r\n  // 判断当前运行环境\r\n  // 只有浏览器环境,才有 document\r\n  if (global.document) {\r\n    const composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose\r\n    store = createStore(\r\n      reducer,\r\n      window.state,\r\n      composeEnhancers(applyMiddleware(thunk))\r\n    )\r\n  } else {\r\n    store = createStore(\r\n      reducer,\r\n      applyMiddleware(thunk)\r\n    )\r\n  }\r\n\r\n  return store\r\n}\r\n\r\nexport default makeStore\r\n```\r\n"}},"__N_SSG":true}